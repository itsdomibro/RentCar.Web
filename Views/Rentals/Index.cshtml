@model RentCar.Web.ViewModels.Rentals.RentalIndexViewModel

@{
    ViewData["Title"] = "Rentals";
}

<h2>Rentals</h2>

<form method="get" class="filter-form">
    <input type="text" name="searchTerm" value="@Model.SearchTerm" placeholder="Search by email, car..." />
    <select name="paymentStatus">
        <option value="">All</option>
        <option value="true" selected="@(Model.PaymentStatusFilter == true)">Paid</option>
        <option value="false" selected="@(Model.PaymentStatusFilter == false)">Unpaid</option>
    </select>
    <input type="date" name="rentalDateFrom" value="@(Model.RentalDateFrom?.ToString("yyyy-MM-dd"))" />
    <input type="date" name="rentalDateTo" value="@(Model.RentalDateTo?.ToString("yyyy-MM-dd"))" />
    <button type="submit">Filter</button>
</form>

<table class="rentals-table">
    <thead>
        <tr>
            <th><a asp-action="Index" asp-route-sortBy="RentalDate" asp-route-sortDesc="@(Model.SortBy=="RentalDate" ? !Model.SortDescending : false)">Rental Date</a></th>
            <th><a asp-action="Index" asp-route-sortBy="ReturnDate" asp-route-sortDesc="@(Model.SortBy=="ReturnDate" ? !Model.SortDescending : false)">Return Date</a></th>
            <th><a asp-action="Index" asp-route-sortBy="TotalPrice" asp-route-sortDesc="@(Model.SortBy=="TotalPrice" ? !Model.SortDescending : false)">Total Price</a></th>
            <th>Email</th>
            <th>Car</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
    @foreach (var rental in Model.Rentals)
    {
        <tr>
            <td>@rental.RentalDate.ToShortDateString()</td>
            <td>@rental.ReturnDate.ToShortDateString()</td>
            <td>@rental.TotalPrice.ToString("C")</td>
            <td>@rental.Email</td>
            <td>@rental.Name @rental.Model (@rental.Year)</td>
            <td>@(rental.PaymentStatus ? "Paid" : "Unpaid")</td>
            <td>
                <a asp-controller="Payments" asp-action="Create" asp-route-rentalId="@rental.RentalId">Make Payment</a>
                <a asp-action="Details" asp-route-id="@rental.RentalId">Details</a> |
                <a asp-action="Update" asp-route-id="@rental.RentalId">Edit</a> |
                <a asp-action="Delete" asp-route-id="@rental.RentalId">Delete</a>
            </td>
        </tr>
    }
    </tbody>
</table>

<a asp-action="Create">Create New Rental</a>